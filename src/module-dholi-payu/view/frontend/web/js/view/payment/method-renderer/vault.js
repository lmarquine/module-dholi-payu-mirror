define(["jquery","ko","Dholi_Payment/js/vault","Magento_Checkout/js/model/quote","Magento_Catalog/js/price-utils"],function(d,c,a,b,e){return a.extend({defaults:{template:"Dholi_PayU/payment/vault-form"},totals:c.observable(window.checkoutConfig.totalsData),installments:c.observableArray(),initialize:function(){let self=this;self._super()},getInstallments:function(){let self=this;self.installments.removeAll();d.ajax({dataType:"json",method:"POST",data:{paymentMethod:self.getCardType(),receipt:window.checkoutConfig.payment[self.getParentCode()].receipt,amount:self.getTotalOrderAmountForInstallments()},url:self.getInstallmentsUrl(),context:document.body}).done(function(f){if(f.code==200){let r=JSON.parse(f.data);let installmentAmount=null;let installmentAmountOriginal=null;let text,value=null;let totalAmount=null;let interest=0;let installment=0;let priceFormat=b.getPriceFormat();_.each(r.paymentMethodFee[0].pricingFees,function(h,g){installment=parseInt(h.installments);installmentAmount=Number(Math.round(Math.abs(+h.pricing.totalValue/installment||0)+"e+7")+("e-7"));interest=h.pricing.payerDetail.interest;if(installment===1){installmentAmountOriginal=self.getFirstInstallmentAmount();installmentAmount=e.formatPrice(installmentAmountOriginal,priceFormat);totalAmount=installmentAmount}else{if(installment>self.getTotalInstallments()){return true}if(self.getMinInstallment()>0){if(installmentAmount<self.getMinInstallment()){return true}}totalAmount=e.formatPrice(installmentAmount*installment,priceFormat);installmentAmountOriginal=installmentAmount;installmentAmount=e.formatPrice(installmentAmount,priceFormat)}text=installment+"x de ".concat(installmentAmount).concat(" = "+totalAmount).concat((installment===1&&self.getPercentualDiscount()>0?" ("+self.getPercentualDiscount()+"% off)":"")).concat(interest>0?" c/ juros":"");value=installment+"-"+installmentAmountOriginal;self.installments.push({v:value,t:text})})}})}})});