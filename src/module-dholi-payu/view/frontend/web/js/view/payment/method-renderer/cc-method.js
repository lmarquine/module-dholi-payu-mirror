define(["jquery","ko","mage/url","Dholi_Payment/js/cards","Magento_Payment/js/model/credit-card-validation/credit-card-data","Magento_Checkout/js/model/quote","Magento_Catalog/js/price-utils","Magento_Checkout/js/model/full-screen-loader","Magento_Checkout/js/checkout-data","Magento_Vault/js/view/payment/vault-enabler"],function(f,i,b,g,c,a,h,j,e,d){return g.extend({defaults:{template:"Dholi_PayU/payment/cc-form",code:"dholi_payments_payu_cc"},parentCode:"dholi_payments_payu",totals:i.observable(window.checkoutConfig.totalsData),initialize:function(){let self=this;self._super();self.vaultEnabler=new d();self.vaultEnabler.setPaymentCode(self.getVaultCode());this._initialize()},_initialize:function(){payU.setLanguage(window.checkoutConfig.payment[this.parentCode].language);payU.setURL(window.checkoutConfig.payment[this.getCode()].url.payments);payU.setPublicKey(window.checkoutConfig.payment[this.getCode()].publicKey);payU.setAccountID(window.checkoutConfig.payment[this.getCode()].accountId)},initObservable:function(){this._super().observe();return this},isActive:function(){return true},isVaultEnabled:function(){return this.vaultEnabler.isVaultEnabled()},getData:function(){let data={method:this.item.method,additional_data:{cc_number:this.creditCardNumber(),cc_type:this.creditCardBrand(),cc_expiry:this.creditCardExpiry(),cc_cvv:this.creditCardCvv(),cc_owner:f("#".concat(this.getCode()).concat("_owner")).val(),cc_installments:f("#".concat(this.getCode()).concat("_installments")).val()}};this.vaultEnabler.visitAdditionalData(data);return data},getLogoUrl:function(){return window.checkoutConfig.payment.dholi_payments_payu.url.logo},creditCardNumberBlurEvent:function(){let value=this.creditCardNumber();if(value){this.creditCardNumberStatusListen();this.installmentsListen()}},installmentsListen:function(){let self=this;self.installments.removeAll();f.ajax({dataType:"json",method:"POST",data:{paymentMethod:self.creditCardBrand,receipt:window.checkoutConfig.payment[self.getCode()].receipt,amount:self.getTotalOrderAmountForInstallments()},url:self.getInstallmentsUrl(),context:document.body}).done(function(k){if(k.code==200){let r=JSON.parse(k.data);let installmentAmount=null;let installmentAmountOriginal=null;let text,value=null;let totalAmount=null;let interest=0;let installment=0;let priceFormat=a.getPriceFormat();_.each(r.paymentMethodFee[0].pricingFees,function(m,l){installment=parseInt(m.installments);installmentAmount=Number(Math.round(Math.abs(+m.pricing.totalValue/installment||0)+"e+7")+("e-7"));interest=m.pricing.payerDetail.interest;if(installment===1){installmentAmountOriginal=self.getFirstInstallmentAmount();installmentAmount=h.formatPrice(installmentAmountOriginal,priceFormat);totalAmount=installmentAmount}else{if(installment>self.getTotalInstallments()){return true}if(self.getMinInstallment()>0){if(installmentAmount<self.getMinInstallment()){return true}}totalAmount=h.formatPrice(installmentAmount*installment,priceFormat);installmentAmountOriginal=installmentAmount;installmentAmount=h.formatPrice(installmentAmount,priceFormat)}text=installment+"x de ".concat(installmentAmount).concat(" = "+totalAmount).concat((installment===1&&self.getPercentualDiscount()>0?" ("+self.getPercentualDiscount()+"% off)":"")).concat(interest>0?" c/ juros":"");value=installment+"-"+installmentAmountOriginal;self.installments.push({v:value,t:text})})}})}})});